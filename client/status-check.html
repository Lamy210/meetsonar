<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>React Status Check</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #1e293b;
            color: #f1f5f9;
        }
        .test-section {
            background: #334155;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
        }
        .success { color: #22c55e; }
        .error { color: #ef4444; }
        .loading { color: #fbbf24; }
    </style>
</head>
<body>
    <h1>React Application Status Check</h1>
    
    <div class="test-section">
        <h3>Basic Tests</h3>
        <p>Page Load: <span class="success">✅ OK</span></p>
        <p>JavaScript: <span id="js-status" class="loading">⏳ Testing...</span></p>
        <p>DOM Ready: <span id="dom-status" class="loading">⏳ Testing...</span></p>
        <p>React Scripts: <span id="react-status" class="loading">⏳ Testing...</span></p>
    </div>

    <div class="test-section">
        <h3>React Root Element</h3>
        <div id="root" style="border: 2px solid #64748b; padding: 20px; margin: 10px 0;">
            <p style="color: #94a3b8;">React app should appear here...</p>
        </div>
    </div>

    <div class="test-section">
        <h3>Manual Actions</h3>
        <button onclick="loadReactApp()">Load React App</button>
        <button onclick="checkElements()">Check Elements</button>
        <button onclick="testAPI()">Test API</button>
    </div>

    <div class="test-section">
        <h3>Console Log</h3>
        <div id="console-log" style="background: #1e293b; padding: 10px; border-radius: 4px; max-height: 200px; overflow-y: auto; font-family: monospace;"></div>
    </div>

    <script>
        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const color = type === 'error' ? '#ef4444' : type === 'success' ? '#22c55e' : '#94a3b8';
            const logDiv = document.getElementById('console-log');
            logDiv.innerHTML += `<div style="color: ${color}">[${timestamp}] ${message}</div>`;
            logDiv.scrollTop = logDiv.scrollHeight;
            console.log(`[${timestamp}] ${message}`);
        }

        function updateStatus(id, success, message) {
            const element = document.getElementById(id);
            if (element) {
                element.innerHTML = success ? `<span class="success">✅ ${message}</span>` : `<span class="error">❌ ${message}</span>`;
            }
        }

        // Test JavaScript
        try {
            updateStatus('js-status', true, 'OK');
            log('JavaScript is working', 'success');
        } catch (error) {
            updateStatus('js-status', false, 'Error');
            log('JavaScript error: ' + error.message, 'error');
        }

        // Test DOM Ready
        document.addEventListener('DOMContentLoaded', () => {
            updateStatus('dom-status', true, 'OK');
            log('DOM is ready', 'success');
        });

        function loadReactApp() {
            log('Loading React app...');
            const script = document.createElement('script');
            script.type = 'module';
            script.src = '/src/main.tsx';
            script.onload = () => {
                updateStatus('react-status', true, 'Loaded');
                log('React script loaded successfully', 'success');
                
                // Check if React rendered anything
                setTimeout(() => {
                    const root = document.getElementById('root');
                    if (root && root.children.length > 0) {
                        log('React components rendered', 'success');
                        root.style.borderColor = '#22c55e';
                    } else {
                        log('React script loaded but no components rendered', 'error');
                        root.style.borderColor = '#ef4444';
                    }
                }, 2000);
            };
            script.onerror = (error) => {
                updateStatus('react-status', false, 'Failed');
                log('React script failed to load: ' + error, 'error');
            };
            document.head.appendChild(script);
        }

        function checkElements() {
            const root = document.getElementById('root');
            log(`Root element exists: ${!!root}`);
            log(`Root element children count: ${root ? root.children.length : 0}`);
            log(`Root element innerHTML length: ${root ? root.innerHTML.length : 0}`);
        }

        function testAPI() {
            log('Testing API...');
            fetch('/api/rooms')
                .then(response => {
                    log(`API Response Status: ${response.status}`, response.ok ? 'success' : 'error');
                    return response.json();
                })
                .then(data => {
                    log(`API Data: ${JSON.stringify(data)}`, 'success');
                })
                .catch(error => {
                    log(`API Error: ${error.message}`, 'error');
                });
        }

        // Error handlers
        window.addEventListener('error', (event) => {
            log(`Error: ${event.error.message} at ${event.filename}:${event.lineno}`, 'error');
        });

        window.addEventListener('unhandledrejection', (event) => {
            log(`Unhandled Promise Rejection: ${event.reason}`, 'error');
        });

        // Auto-start tests
        setTimeout(() => {
            updateStatus('dom-status', true, 'OK');
            log('DOM is ready', 'success');
            loadReactApp();
        }, 100);

        log('Status check page initialized');
    </script>
</body>
</html>
